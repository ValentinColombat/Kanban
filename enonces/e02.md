# ğŸ› ï¸ Challenge E02 â€“ Route utilisateur connectÃ© & gestion des rÃ´les

## Objectifs

- Ajouter une route GET `/auth/me` permettant de rÃ©cupÃ©rer les informations de l'utilisateur actuellement connectÃ©.
- Mettre en place un systÃ¨me de rÃ´les (admin, utilisateur...) en base de donnÃ©es.
- Associer un rÃ´le Ã  chaque utilisateur.

## 1. Route `/auth/me`

CrÃ©e une route GET `/auth/me` qui renvoie les informations de l'utilisateur actuellement connectÃ©.

Quelques Ã©lÃ©ments Ã  considÃ©rer :

- Cette route ne doit Ãªtre accessible que si l'utilisateur est authentifiÃ©.
- Le token JWT contient les informations nÃ©cessaires pour identifier l'utilisateur. Ces informations doivent Ãªtre accessibles dans la route.
- Les informations doivent Ãªtre extraites depuis la base de donnÃ©es pour Ã©viter de renvoyer directement ce quâ€™il y a dans le token.

Tu devras probablement intervenir dans les fichiers suivants :

- Un middleware d'authentification dÃ©jÃ  en place (oÃ¹ ?)
- Un controller
- Le fichier de routes

**Tests attendus** :

- un appel Ã  `/auth/me` avec un token valide retourne un objet reprÃ©sentant lâ€™utilisateur (par exemple : `id`, `username`).
- dans le frontend, on devrait voir apparaÃ®tre le nom de l'utilisateur dans la navbar

## 2. DÃ©but de mise en place dâ€™un systÃ¨me de rÃ´les

Ajoute une entitÃ© `Role` permettant de distinguer les types dâ€™utilisateurs.

TÃ¢ches Ã  effectuer :

- CrÃ©er un modÃ¨le Sequelize pour `Role`
- Relier `User` Ã  `Role` via une relation `belongsTo`
- Mettre Ã  jour la base de donnÃ©es
- Ajouter quelques rÃ´les de base (`user`, `admin`) dans le fichier de seeding
- Lors de l'inscription dâ€™un nouvel utilisateur, il doit avoir automatiquement le rÃ´le `user`
- Inclure le rÃ´le dans la rÃ©ponse de la route `/auth/me`

- Tu devras avoir deux rÃ´les ajoutÃ©s Ã  la base de donnÃ©es (utilise le seeding ğŸ’ª) :

```js
{
    id: 1,
    name: "admin",
},
{
    id: 2,
    name: "user",
}
```

**Tests attendus** :

- les rÃ´les sont prÃ©sents dans la BDD
- les utilisateurs possÃ¨dent chacun un rÃ´le
- la route `/auth/me` renvoie aussi le rÃ´le associÃ©.

## CritÃ¨res de validation

âœ… La route GET `/auth/me` fonctionne uniquement si le token est prÃ©sent et valide

âœ… La rÃ©ponse contient les infos de l'utilisateur ainsi que son rÃ´le

âœ… Un nouvel utilisateur a automatiquement le rÃ´le user

âœ… Le frontend affiche les bonnes informations de l'utilisateur connectÃ© dans la navbar
